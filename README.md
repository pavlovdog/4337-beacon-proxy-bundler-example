# AA bundler + `4337-beacon-proxy`

This repo provides an example of integrating the AA bundler with a smart account, created with [4337-beacon-proxy contracts]().
Here I'm using a Stackup bundler, but any other bundler will work as well.

## Running locally locally

- Install the dependencies

```bash
yarn
```

- Create a `.env` file with the following content:

```bash
PAYMASTER_URL="https://api.stackup.sh/v1/paymaster/<API_KEY>"
RPC_URL="https://api.stackup.sh/v1/node/<API_KEY>"
```

The current version is configured for Base Sepolia. Get your Stackup API key in the [dashboard](https://app.stackup.sh/hello).

- Deploy an account using the AA bundler

```
$ npx ts-node scripts/0-deploy-account.ts 
Account owner address: 0x69757d1a101A222Da212d044877fA07455B7B869
Account address: 0x716bB91eadBdaF8b63970Cd3b7c6Bca51feA944a
Signed UserOperation: {"sender":"0x716bB91eadBdaF8b63970Cd3b7c6Bca51feA944a","nonce":"0x0","initCode":"0x48b65829444a3bf831eeea5861e3bf7303685ebeda9fc1ae00000000000000000000000069757d1a101a222da212d044877fa07455b7b869","callData":"0xb61d27f60000000000000000000000003870419ba2bbf0127060bcb37f69a1b1c090992b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000044095ea7b3000000000000000000000000e93eca6595fe94091dc1af46aac2a8b5d799077000000000000000000000000000000000000000000000000000000000000186a000000000000000000000000000000000000000000000000000000000","callGasLimit":"0x9c95","verificationGasLimit":"0x430e0","preVerificationGas":"0x7f67319","maxFeePerGas":"0x11aa22","maxPriorityFeePerGas":"0x113e10","paymasterAndData":"0x9d6ac51b972544251fcc0f2902e633e3f9bd3f290000000000000000000000000000000000000000000000000000000065c2b299000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f145068663f320b7c3f2dd793d26e7809027fafa521433a8bfeb4642d81e664f1ceb6df3af67b9c5d71836fbb966f1720129b9e531aaf4186ebb9192cffc8b8a1b","signature":"0x4ab635d3e8714f10accd0248a8301f017d6208c32c5c1c9d97ec40f3cc6008ec2b49071ddf33ca53e40c6ae8e71275715cacdf61bf78e1e4dbb59ed39a67376f1b"}
UserOpHash: 0x7b947b0ce547fe95da82bc095f72f44f25efd445b04631957845a65c22052e23
Waiting for transaction...
Transaction hash: 0x9e312069fb36de3e190c20d8daed06bbd1b10b2294c0eb36586adfaaec0a122a
View here: https://jiffyscan.xyz/userOpHash/0x7b947b0ce547fe95da82bc095f72f44f25efd445b04631957845a65c22052e23
```